<link rel="import" href="../../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../app-options-item/app-options-item.html">

<dom-module id="app-options-menu">
  <style>
    :host {
      position: fixed;
      display: none;
      background-color: white;
      top: var(--header-height);
      right: 0;
      max-width: 200px;
      width: 33vw;
      height: calc(95% - var(--header-height));
      border-radius: 0 0 .3em .3em;
      box-shadow: 0 2px 2px 0 rgba(0, 0, 0, .14),
        0 3px 1px -2px rgba(0, 0, 0, .2),
        0 1px 5px 0 rgba(0, 0, 0, .12);
    }

    :host[opened] {
      display: block;
    }

    :host .options-scrim {
      display: none;
      position: fixed;
      top: 0;
      bottom: 0;
      left: 0;
      right: 0;
    }

    :host[opened] .options-scrim {
      display: block;
    }

    :host .options-view {
      outline: none;
      position: relative;
      overflow-y: auto;
      height: 100%;
      transition: transform .1s ease-out;
      transform-origin: 0 0 ;
      transform: scaleY(0.99);
    }

    .options-view__animate {
      transform: scaleY(1);
    }

    :host .options-btn {
      background: url('/images/ic_options_24px.svg') center center no-repeat;
    }
  </style>

  <template>
    <div class="options-scrim js-options-scrim" on-tap="_handleScrimTap"></div>
    <aside class="options-view js-options-view">
      <app-options-item title="Option 1"></app-options-item>
      <app-options-item title="Option 2"></app-options-item>
      <app-options-item title="Option 3"></app-options-item>
      <app-options-item title="Option 4"></app-options-item>
      <app-options-item title="Option 1"></app-options-item>
      <app-options-item title="Option 2"></app-options-item>
      <app-options-item title="Option 3"></app-options-item>
      <app-options-item title="Option 4"></app-options-item>
      <app-options-item title="Option 1"></app-options-item>
      <app-options-item title="Option 2"></app-options-item>
      <app-options-item title="Option 3"></app-options-item>
      <app-options-item title="Option 4"></app-options-item>
      <app-options-item title="Option 1"></app-options-item>
      <app-options-item title="Option 2"></app-options-item>
      <app-options-item title="Option 3"></app-options-item>
      <app-options-item title="Option 5"></app-options-item>
      <app-options-item title="Option 1"></app-options-item>
      <app-options-item title="Option 2"></app-options-item>
      <app-options-item title="Option 3"></app-options-item>
      <app-options-item title="Option 4"></app-options-item>
      <app-options-item title="Option 1"></app-options-item>
      <app-options-item title="Option 2"></app-options-item>
      <app-options-item title="Option 3"></app-options-item>
      <app-options-item title="Option 4"></app-options-item>
      <app-options-item title="Option 1"></app-options-item>
      <app-options-item title="Option 2"></app-options-item>
      <app-options-item title="Option 3"></app-options-item>
      <app-options-item title="Option 4"></app-options-item>
      <app-options-item title="Option 1"></app-options-item>
      <app-options-item title="Option 2"></app-options-item>
      <app-options-item title="Option 3"></app-options-item>
      <app-options-item title="Option 4"></app-options-item>
    </aside>
  </template>

  <!-- Creates the element's prototype and registers it -->
  <script>
    Polymer({
      is: 'app-options-menu',

      properties: {
        opened: {
          type: Boolean,
          reflectToAttribute: true,
          observer: '_openedChanged'
        }
      },

      ready: function() {
        this.view = this.querySelector('.js-options-view');
        this.scrim = this.querySelector('.js-options-scrim');
        this._close = this._close.bind(this);
        this._open = this._open.bind(this);
      },

      _openedChanged: function(newValue, oldValue){
        newValue ? this._open() : this._close();
      },

      _handleScrimTap: function() {
        this.opened = false;
      },

      _close: function() {
        document.body.classList.remove('noscroll');
        this.view.classList.remove('options-view__animate');
      },

      _open: function() {
        document.body.classList.add('noscroll');
        requestAnimationFrame(() => this.view.classList.add('options-view__animate'));
      }
    });
  </script>
</dom-module>